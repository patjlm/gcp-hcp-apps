applications:
  prometheus:
    project: default
    namespace: argocd
    finalizers:
    - resources-finalizer.argocd.argoproj.io
    syncPolicy:
      automated:
        prune: false
        selfHeal: true
      syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
    destination:
      name: '{{ .Values.cluster.name }}'
      namespace: monitoring
    source:
      repoURL: https://prometheus-community.github.io/helm-charts
      targetRevision: 77.8.0
      chart: kube-prometheus-stack
      helm:
        valuesObject:
          grafana:
            service:
              type: ClusterIP
            persistence:
              enabled: true
              size: 50Gi
            replicas: 2
          cluster:
            region: '{{ .Values.cluster.region }}'
            projectId: '{{ .Values.cluster.projectId }}'
            vpcId: '{{ .Values.cluster.vpcId }}'
          prometheus:
            prometheusSpec:
              retention: 30d
              replicas: 2
              resources:
                requests:
                  memory: 4Gi
                  cpu: 1000m
  cert-manager:
    project: default
    namespace: argocd
    finalizers:
    - resources-finalizer.argocd.argoproj.io
    syncPolicy:
      automated:
        prune: false
        selfHeal: true
      syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
    destination:
      name: '{{ .Values.cluster.name }}'
      namespace: cert-manager
    source:
      repoURL: https://charts.jetstack.io
      targetRevision: v1.16.0
      chart: cert-manager
      helm:
        valuesObject:
          crds:
            enabled: true
          prometheus:
            enabled: true
          webhook:
            securePort: 10260
          cainjector:
            enabled: true
  argocd:
    project: default
    namespace: argocd
    finalizers:
    - resources-finalizer.argocd.argoproj.io
    syncPolicy:
      automated:
        prune: false
        selfHeal: true
      syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
    destination:
      name: '{{ .Values.cluster.name }}'
      namespace: argocd
    source:
      repoURL: https://argoproj.github.io/argo-helm
      targetRevision: 5.46.0
      chart: argo-cd
      helm:
        valuesObject:
          server:
            service:
              type: ClusterIP
          controller:
            replicas: 1
          repoServer:
            replicas: 1
  hypershift:
    project: default
    namespace: argocd
    finalizers:
    - resources-finalizer.argocd.argoproj.io
    syncPolicy:
      automated:
        prune: false
        selfHeal: true
      syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
    destination:
      name: '{{ .Values.cluster.name }}'
      namespace: hypershift
    source:
      repoURL: '{{ .Values.cluster.repoURL | default "https://github.com/patjlm/gcp-hcp-apps.git" }}'
      targetRevision: '{{ .Values.cluster.targetRevision | default "main" }}'
      path: hypershift
